# -*- coding: utf-8 -*-import osfrom io import BytesIOfrom reportlab.pdfgen import canvasfrom reportlab.lib.pagesizes import A4, cmfrom reportlab.graphics.shapes import *from rest_framework import serializers, viewsetsfrom django.http import HttpResponsefrom rest_framework import statusfrom rest_framework.response import Responsefrom comprobante.models.comprobante import Comprobantefrom rest_framework import statusfrom rest_framework.response import Responsefrom rest_framework.views import APIViewfrom django.http import Http404from reserva.models.reserva import Reservafrom reserva.models.detalle_reserva import DetalleReservafrom catalogo.models.persona import Personathis_path = os.getcwd() + '/pdf_file/'def Voleta(request,):    comprobante=Comprobante.objects.get(id='84145296-b71e-4233-9fc7-4b5b160915e6')    reserva = Reserva.objects.get(comprobante__id=comprobante.id)    persona= Persona.objects.get(reserva__id=reserva.id)    saludo= "holaaaaaaaaaaaa"    #now = datetime.datetime.now()    #p = Institucion.objects.all()    #print(p)    response = HttpResponse(content_type='aplication/pdf')    response['Content-Disposition']='attachment; filename=+hi+.pdf'    #comprobante=Comprobante.objects.filter(id=)    buffer = BytesIO()    c = canvas.Canvas(buffer, pagesize=A4)    c.setFont('Helvetica',10)    x = 20    y = 15    n = 100    m = 15    c.drawString(420,800,comprobante.codigo_comprobante)    c.drawString(150, 720, 'valor de venta')    c.drawString(150,700,str(comprobante.valor_venta))    c.drawString(300, 720, 'precio de venta')    c.drawString(300, 700, str(comprobante.precio_venta))    c.drawString(400, 720, 'igv')    c.drawString(400, 700, str(comprobante.igv))    c.drawString(50, 780, 'Nombres')    c.drawString(20, 750, str(persona.nombre))    c.drawString(150, 750, str(persona.apellido_paterno))    c.drawString(300, 750, str(persona.apellido_materno))    c.drawString(400, 750, str(persona.dni))    reserva_detalle = DetalleReserva.objects.filter(reserva__id=reserva.id)    print("================================>>><<<>>",reserva_detalle)    s=0    for r_d in  reserva_detalle:        #c.drawString(x, 700, str(r_d.cancha))        print("========================>><<",r_d.id)        print("========================>><<", r_d.cancha)        print("========================>><<", r_d.costo)        c.drawString(x, 300, str(r_d.costo))        x=x+n    c.setFont('Helvetica',8)    c.setFont('Helvetica-Bold',8)    c.save()    pdf=buffer.getvalue()    buffer.close()    response.write(pdf)    return responseclass VoletaDetail(APIView):    #authentication_classes = (authentication.TokenAuthentication,)    #permission_classes = [IsAuthenticated, TokenHasScope]    #required_scopes = ['acuerdo', ]    def get_object(self, pk):        try:            return Comprobante.objects.get(pk=pk)        except Comprobante.DoesNotExist:            raise Http404    def get(self, request, pk, format=None):        comprobante = self.get_object(pk)        #serializer = DetalleDepartamentoSerializer(comprobante)        return Response